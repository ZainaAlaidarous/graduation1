<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>ØªØ£ÙƒÙŠØ¯ Ø­Ø¶ÙˆØ± Ø§Ù„Ø­ÙÙ„</title>
  <style>
    body{font-family:Arial,sans-serif;text-align:center;margin-top:40px}
    .card{margin:20px auto;padding:20px;border:1px solid #ddd;border-radius:12px;max-width:520px}
    input,button{padding:10px;margin:8px;font-size:16px}
    #submitBtn{display:none;background:#2563eb;color:#fff;border:none;border-radius:8px;cursor:pointer}
    .member{display:flex;align-items:center;justify-content:space-between;gap:12px;margin:12px 0;padding:10px;border-radius:10px;background:#fafafa;border:1px solid #eee}
    .name{font-weight:600}
    .status{min-width:110px;text-align:center}

    /* ===== CSS Switch (checkbox styled) ===== */
    .switch{
      position:relative;width:70px;height:34px;flex-shrink:0
    }
    .switch input{
      opacity:0;width:0;height:0;position:absolute
    }
    .slider{
      position:absolute;inset:0;background:#e5e7eb;border-radius:999px;transition:.25s ease;
      box-shadow: inset 0 0 0 2px #d1d5db;
    }
    .slider:before{
      content:"";position:absolute;height:26px;width:26px;left:4px;top:4px;background:#ef4444;border-radius:50%;
      transition:.25s ease;
    }
    /* ON state */
    input:checked + .slider{
      background:#d1fae5;box-shadow: inset 0 0 0 2px #34d399;
    }
    input:checked + .slider:before{
      transform:translateX(36px);background:#22c55e;
    }
    /* Labels YES/NO text */
    .switch .off, .switch .on{
      position:absolute;top:50%;transform:translateY(-50%);font-size:12px;font-weight:700;pointer-events:none;
    }
    .switch .off{left:8px;color:#9ca3af}
    .switch .on{right:8px;color:#059669;opacity:0;transition:.2s}
    input:checked ~ .on{opacity:1}
    input:checked ~ .off{opacity:0}
  </style>
</head>
<body>
  <h2>ğŸ‰ ØªØ£ÙƒÙŠØ¯ Ø­Ø¶ÙˆØ± Ø§Ù„Ø­ÙÙ„</h2>

  <div class="card">
    <label>Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ:</label><br>
    <input id="nameInput" type="text" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø£Ù…" />
    <button onclick="checkGuest()">Ù…ØªØ§Ø¨Ø¹Ø©</button>

    <div id="guestList"></div>

    <button id="submitBtn" onclick="submitResponse()">Ø¥Ø±Ø³Ø§Ù„</button>
    <div id="result" style="margin-top:14px"></div>
  </div>

  <script>
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª: Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ => Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙØ±Ø§Ø¯
    const groups = {
      "Ø§Ù„Ø£Ù…": ["Ø§Ù„Ø£Ù…","Ù…Ø­Ù…Ø¯","Ø³Ø§Ø±Ø©"],
      "Ø§Ù„Ø£Ø¨": ["Ø§Ù„Ø£Ø¨","Ø£Ø­Ù…Ø¯"]
    };

    let currentMembers = [];
    let responses = {}; // person -> true/false

    function checkGuest(){
      const key = document.getElementById('nameInput').value.trim();
      const box = document.getElementById('guestList');
      const result = document.getElementById('result');
      const submit = document.getElementById('submitBtn');

      box.innerHTML = "";
      result.innerHTML = "";
      submit.style.display = "none";
      responses = {};
      currentMembers = [];

      if(!groups[key]){
        box.innerHTML = `<p>âŒ Ø§Ù„Ø§Ø³Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯Ø¹ÙˆÙŠÙ†.</p>`;
        return;
      }

      currentMembers = groups[key];
      box.innerHTML = `<p>âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ <b>${key}</b> â€” Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¯Ø¹ÙˆÙŠÙ†: ${currentMembers.length}</p>`;

      // Ø¥Ù†Ø´Ø§Ø¡ ØµÙ Ù„ÙƒÙ„ Ø´Ø®Øµ Ù…Ø¹ Ø³ÙˆÙŠØªØ´
      currentMembers.forEach(person=>{
        responses[person] = null; // Ù„Ù… ÙŠÙØ­Ø¯Ø¯ Ø¨Ø¹Ø¯

        const row = document.createElement('div');
        row.className = 'member';

        const nameEl = document.createElement('div');
        nameEl.className = 'name';
        nameEl.textContent = person;

        const statusEl = document.createElement('div');
        statusEl.id = `status-${person}`;
        statusEl.className = 'status';
        statusEl.textContent = 'â³ Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±';

        const switchWrap = document.createElement('label');
        switchWrap.className = 'switch';

        const cb = document.createElement('input');
        cb.type = 'checkbox';
        cb.setAttribute('aria-label', `ØªØ¨Ø¯ÙŠÙ„ Ø­Ø¶ÙˆØ± ${person}`);
        cb.addEventListener('change', e=>{
          responses[person] = e.target.checked; // true=ÙŠØ­Ø¶Ø±, false=Ù„Ø§
          statusEl.textContent = e.target.checked ? 'âœ… Ø³ÙŠØ­Ø¶Ø±' : 'âŒ Ù„Ù† ÙŠØ­Ø¶Ø±';
          // Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ø¨Ø¹Ø¯ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„
          const allChosen = Object.values(responses).every(v=>v !== null);
          if(allChosen) submit.style.display = 'inline-block';
        });

        const slider = document.createElement('span');
        slider.className = 'slider';

        const offTxt = document.createElement('span');
        offTxt.className = 'off';
        offTxt.textContent = 'Ù„Ø§';

        const onTxt = document.createElement('span');
        onTxt.className = 'on';
        onTxt.textContent = 'Ù†Ø¹Ù…';

        switchWrap.appendChild(cb);
        switchWrap.appendChild(slider);
        switchWrap.appendChild(offTxt);
        switchWrap.appendChild(onTxt);

        row.appendChild(nameEl);
        row.appendChild(switchWrap);
        row.appendChild(statusEl);
        box.appendChild(row);
      });
    }

   function submitResponse(){
  const result = document.getElementById('result');
  const attending = [];
  const notAttending = [];

  for(const [person, val] of Object.entries(responses)){
    (val ? attending : notAttending).push(person);
  }

  // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
  let html = "<h3>ğŸ“‹ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ£ÙƒÙŠØ¯</h3>";
  html += attending.length ? `âœ… <b>Ø§Ù„Ø­Ø§Ø¶Ø±ÙˆÙ†:</b> ${attending.join("ØŒ ")}<br>` : "";
  html += notAttending.length ? `âŒ <b>ØºÙŠØ± Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ†:</b> ${notAttending.join("ØŒ ")}<br>` : "";
  html += "<br>ğŸ‰ Ø´ÙƒØ±Ù‹Ø§ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø±Ø¯ÙƒÙ…!";
  result.innerHTML = html;

  // ---- Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Formspree ----
  fetch("https://formspree.io/f/xdkdrgjo", { 
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      Ø§Ù„Ø§Ø³Ù…: document.getElementById("nameInput").value,
      Ø§Ù„Ø­Ø§Ø¶Ø±ÙˆÙ†: attending.join("ØŒ "),
      Ø§Ù„ØºØ§Ø¦Ø¨ÙˆÙ†: notAttending.join("ØŒ ")
    })
  })
  .then(r => {
    if(r.ok){
      console.log("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯ Ø¥Ù„Ù‰ Formspree");
    } else {
      console.error("âŒ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„");
    }
  });
}

  </script>
</body>
</html>
